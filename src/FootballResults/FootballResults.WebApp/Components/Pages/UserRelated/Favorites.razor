@page "/favorites"
@using Microsoft.AspNetCore.Authorization
@attribute [Authorize(Roles = "User")]

@inject IUserService UserService
@inject NavigationManager NavigationManager

<PageTitle>Favorites</PageTitle>

<h1>Favorites</h1>

@if (User != null)
{
    @if (User.FavoriteLeagues.Count() > 0)
    {
        <h2>Leagues</h2>
        <div class="leagues">
            @foreach (var league in User.FavoriteLeagues.OrderBy(l => l.CountryID).ThenBy(l => l.Name))
            {
                <LeagueCard League="league" BookmarkClicked="OnBookmarkClicked" />
            }
        </div>
    }
    @if (User.FavoriteTeams.Count() > 0)
    {
        <h2>Teams</h2>
        <div class="teams">
            @foreach (var team in User.FavoriteTeams.OrderBy(t => t.Name))
            {
                <div class="teamContainer">
                    <TeamCard Team="team" />
                    <BookmarkIcon Bookmark="team" DefaultColor="defaultLight" ButtonClicked="OnBookmarkClicked" />
                </div>
            }
        </div>
    }
    @if ((User.FavoriteLeagues.Count() == 0) && (User.FavoriteTeams.Count() == 0))
    {
        <p>You can bookmark your favorite leagues and teams for quick access</p>
    }
}


@code {
    [CascadingParameter(Name = "User")]
    public User? User { get; set; }

    private void OnBookmarkClicked()
    {
        StateHasChanged();
    }
}
